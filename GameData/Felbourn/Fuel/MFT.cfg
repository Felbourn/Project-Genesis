
@PART[*]:Final
{
	!MODULE[ModuleFuelTanks] {}
}

@PART[*]:HAS[#MFT_can[1]&~MFT_type[]]:Final
{
	MFT_type = Default	
}

@PART[*]:HAS[#MFT_can[1]]:Final
{
	%ACTIONS
	{
		action = add cylinder ModuleFuelTanks
	}
	MODULE
	{
		name = ModuleFuelTanks
		type = #$/MFT_type$

		volume = #$/MFT_canDia$
		@volume *= #$@MM_VARS/DiamToRadius$
		@volume != #$@MM_VARS/Squared$
		@volume *= #$@MM_VARS/PI$
		@volume *= #$/MFT_canHgt$
		@volume *= #$/MFT_util$
	}
	@TechRequired = inProgress
}

@PART[*]:HAS[#MFT_sphere[1]]:Final
{
	%ACTIONS
	{
		action = add sphere ModuleFuelTanks
	}
	%MODULE[ModuleFuelTanks]
	{
		%type = Default

		change = #$/MFT_dia$
		@change *= #$@MM_VARS/DiamToRadius$
		@change != #$@MM_VARS/Cubed$
		@change *= #$@MM_VARS/PI$
		@change *= #$@MM_VARS/SphereRatio$
		@change *= #$@MM_VARS/LitersPerCM$
		@change *= #$@MM_VARS/SphereTankUtil$
		@change *= #$/MFT_util$

		%volume += #$change$
		
		!change = DELETE
	}
	@TechRequired = inProgress
}

@PART[*]:HAS[@MODULE[ModuleFuelTanks]]:Final
{
	@mass = #$/MODULE[ModuleFuelTanks]/volume$
	@mass *= #$@MM_VARS/FuelMassPerLiter$
	@mass /= #$@MM_VARS/KgPerTon$
}
