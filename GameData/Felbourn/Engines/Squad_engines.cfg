//-------------------------------------------------------------------------------------------------
// 48-7S "Spark" Liquid Fuel Engine
@PART[liquidEngineMini]:Final
{
	@title ^= : FIX ME::
	%MODULE[ModuleEngineConfigs]
	{
		configuration = Hypergolic
		@CONFIG[Hypergolic]
		{
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesFX]/maxThrust$
			atmosphereCurve
			{
				key = 0 254
				key = 1 202
				key = 3 0.001
			}
		}
		@CONFIG[Monoprop]
		{
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesFX]/maxThrust$
			atmosphereCurve
			{
				key = 0 243
				key = 1 186	
				key = 3 0.001
			}
		}
	}
	@mass = #$/MODULE[ModuleEnginesFX]/maxThrust$
	@mass /= #$@MM_VARS/UpperTWR_12$
	@mass /= #$@MM_VARS/Gravity$

	@MODULE[ModuleEngines*]
	{
		@name = ModuleEnginesFX
        %runningEffectName = powersmoke
		%powerEffectName = powerflame
		!fxOffset = del	
	}
	!EFFECTS {}
	EFFECTS
	{
		powerflame
		{
			AUDIO
			{
				channel = Ship
				clip = KWRocketry/Soundbank/sound_spsloop
				volume = 0.0 0.0
				volume = 1.0 1.0
				pitch = 0.0 0.8
				pitch = 1.0 1.5
				loop = true
			}
			MODEL_MULTI_PARTICLE_PERSIST
			{
				name = flamethrust
				modelName = MP_Nazari/FX/nasa4engine
				transformName = thrustTransform
				emission = 0.0 0.0
				emission = 0.05 0.35
				emission = 1.0 1.2
				speed = 0.0 0.2
				speed = 1.0 0.3
				energy = 0.0 1.2
				energy = 1.0 1.5
				offset = 0 1
				offset = 1 1
				grow = 0 4
				grow = 1 5
				size = 0 0.3
				size = 1 0.5
				fixedEmissions = false
			}
		}
		engage
		{
			AUDIO
			{
				channel = Ship
				clip = sound_vent_medium
				loop = false
			}
		}
		disengage
		{
			AUDIO
			{
				channel = Ship
				clip = sound_vent_soft
				loop = false
			}
		}
	}
}

//-------------------------------------------------------------------------------------------------
// LV-909 "Terrier" Liquid Fuel Engine
@PART[liquidEngine3]:Final
{
	@title ^= : FIX ME::
	%MODULE[ModuleEngineConfigs]
	{
		configuration = Kerolox
		@CONFIG[Kerolox]
		{
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesFX]/maxThrust$
			atmosphereCurve
			{
				key = 0 278
				key = 1 69
				key = 3 0.001
			}
		}
		@CONFIG[Hydrolox]
		{
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesFX]/maxThrust$
			atmosphereCurve
			{
				key = 0 308
				key = 1 71
				key = 3 0.001
			}
		}
		@CONFIG[Hypergolic]
		{
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesFX]/maxThrust$
			atmosphereCurve
			{
				key = 0 288
				key = 1 63
				key = 3 0.001
			}
		}
	}
	@mass = #$/MODULE[ModuleEnginesFX]/maxThrust$
	@mass /= #$@MM_VARS/UpperTWR_12$
	@mass /= #$@MM_VARS/Gravity$
}

//-------------------------------------------------------------------------------------------------
// RE-M3 "Mainsail" Liquid Engine
@PART[liquidEngine1-2]:Final
{
	@title ^= : FIX ME::
	!MODULE[TweakScale] {}
	@MODULE[ModuleEnginesFX]
	{
		@maxThrust = 1800
	}
	%MODULE[ModuleEngineConfigs]
	{
		configuration = Kerolox
		@CONFIG[Kerolox]
		{
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesFX]/maxThrust$
			atmosphereCurve
			{
				key = 0 236
				key = 1 217
				key = 3 0.001
			}
		}
		@CONFIG[Hydrolox]
		{
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesFX]/maxThrust$
			atmosphereCurve
			{
				key = 0 268
				key = 1 232
				key = 3 0.001
			}
		}
	}
	@mass = #$/MODULE[ModuleEnginesFX]/maxThrust$
	@mass /= #$@MM_VARS/LowerTWR_25$
	@mass /= #$@MM_VARS/Gravity$

	!EFFECTS {}
	EFFECTS
	{
		powerflame
		{
			MODEL_MULTI_PARTICLE_PERSIST
			{
				name = flamethrust
				modelName = MP_Nazari/FX/flamelarge
				transformName = thrustTransform
				emission = 0.0 0.0
				emission = 0.05 0.49
				emission = 1.0 1.8
				speed = 0.0 1.4
				speed = 1.0 1.8
				energy = 0.0 0.5
				energy = 1.0 1.2
				offset = 0 1
				offset = 1 1
				grow = 0 -1
				grow = 1 -0.5
				grow
				{
					density = 0 -0.5
					density = 1 0
				}
				size
				{
					density = 0 3
					density = 1 1
				}
				offset
				{
					density = 0 5
					density = 1 1
				}
				fixedEmissions = false
			}
			AUDIO
			{
				channel = Ship
				clip = Felbourn/Sounds/DeltaLoop
				volume = 0.0 0.0
				volume = 1.0 1.0
				pitch = 0.0 0.2
				pitch = 1.0 1.0
				loop = true
			}
		}
		powersmoke
		{
			MODEL_MULTI_PARTICLE_PERSIST
			{
				name = smokethrust
				modelName = MP_Nazari/FX/smokebooster2
				transformName = thrustTransform
				emission = 0.0 0.0  // Curve for emission like stock
				emission = 0.07 0.0  // Curve for emission like stock
				emission = 0.2 0.4  // Curve for emission like stock
				emission = 1.0 1.1  // Curve for emission like stock
				energy = 0.0 0.2 // Same for energy
				energy = 1.0 3.2 // Same for energy
				energy
				{
					mach = 0 1
					mach = 1 2
					mach = 2 10
				}
				speed = 0.0 1.0  // And speed
				speed = 1.0 0.8  // And speed
				speed
				{
					mach = 0 1
					mach = 1 0.5
					mach = 2 0.1
				}
				grow = 0.0 0.0 // Grow the particles at 0% per seconds ( 0.02 would be 2% )
				grow = 1.0 0.11 // Grow the particles at 0% per seconds ( 0.02 would be 2% )
				scale = 0.0 1.0 // Rescale the emitters to +0%
				scale = 1.0 1.0 // Rescale the emitters to +0%
				offset = 0.0 0.0  // Move the particle emitter away from its default position by x meters
				offset = 1.0 0.5  // Move the particle emitter away from its default position by x meters	
				size = 0.0 1.0 // Rescale the particles to +0%
				size = 1.0 1.1 // Rescale the particles to +0%
				
				renderMode = "Billboard"  // Render mode : Billboard / SortedBillboard / HorizontalBillboard / VerticalBillboard / Stretch
				collide = false // Collision active or not
				collideRatio = 0 // how the particles react on collision. 1 is a mirror bounce, 0 is go parallel to the hit surface
				fixedScale = 1.0 // Fixed rescale of the particle emitter (for when you rescale the model)
				
				sizeClamp = 50 // Limits particle size. Default to 50
				// ***************
				// From here the value are not the default anymore. 
				// ***************
				angle = 0.0 1.0 // Display if the angle between the emitter transform and camera is lower than 45Â° 	
				angle = 45.0 1.0
				angle = 50.0 1.0
				distance = 0.0 1.0 // Display if the distance to camera is higher than 110
				distance = 100.0 1.0
				distance = 110.0 1.0
				
				emission
				{
					mach = 0.0 1.0 
					mach = 0.8 1.0 // don't display until mach .8
					mach = 1.0 1.0
					density = 1.0 1.0
					density = 0.4 1.0 // don't display over .4 atmo
					density = 0.3 1.0 
					density = 0.002 1.0
					density = 0.001 0.0 // and stop under .001
				}
				size
				{
					density = 1.0 2.0
					density = 0.01 5.0
				}	
			}
		}
		engage
		{
			AUDIO
			{
				channel = Ship
				clip = Felbourn/Sounds/ShuttleStart
				volume = 1
				pitch = 1
				loop = false
			}
		}
		disengage
		{
			AUDIO
			{
				channel = Ship
				clip = sound_vent_soft
				volume = 1.0
				pitch = 2.0
				loop = false
			}
		}
		flameout
		{
			AUDIO
			{
				channel = Ship
				clip = sound_explosion_low
				volume = 1.0
				pitch = 2.0
				loop = false
			}
		}
	}
}
