
@PART[*]:HAS[#CrewCapacity[*]]:AFTER[zPhase1Init]
{
	%ACTIONS
	{
		action = remove crew capacity
	}
	!CrewCapacity = DELETE // nothing gets crew capacity unless I say so
}

@PART[*]:HAS[@CREW_VOLUME[Sphere]]:AFTER[zPhase1Init]
{
	// V = 4/3 * π * r^3
	%ACTIONS
	{
		action = define crew capacity for 'sphere'
	}
	@CREW_VOLUME[Sphere]
	{
		crew = #$dia$
		@crew *= #$@MM_VARS/DiamToRadius$
		@crew != #$@MM_VARS/Cubed$
		@crew *= #$@MM_VARS/PI$
		@crew *= #$@MM_VARS/SphereRatio$
	}
}

@PART[*]:HAS[@CREW_VOLUME[Can]]:AFTER[zPhase1Init]
{
	// V = π * r^2 * h
	%ACTIONS
	{
		action = define crew capacity for 'can'
	}
	@CREW_VOLUME[Can]
	{
		crew = #$dia$
		@crew *= #$@MM_VARS/DiamToRadius$
		@crew != #$@MM_VARS/Squared$
		@crew *= #$@MM_VARS/PI$
		@crew *= #$hgt$
	}
}

// divide and then truncate to an integer to get the true crew capacity based on interior volume
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[*]]]:AFTER[zPhase1Init]
{
	%ACTIONS
	{
		action = set CrewCapacity to 1, then incrment as needed
	}
	@CREW_VOLUME,*
	{
		@crew /= 5     // every 5 cubic meters of internal volume can have 1 crew
	}
	CrewCapacity = 1   // always room for 1 if we have decided there's any room at all
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>2]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>3]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>4]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>5]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>6]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>7]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>8]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>9]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS:HAS[#crew[>10]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>11]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>12]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>13]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>14]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>15]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>16]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>17]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>18]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>19]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}
@PART[*]:HAS[@CREW_VOLUME:HAS[#crew[>20]]]:AFTER[zPhase1Init]
{
	@CrewCapacity += 1
}

@PART[*]:HAS[#crew[*]]:AFTER[zPhase7Cleanup]
{
	!crew = DELETE
}
