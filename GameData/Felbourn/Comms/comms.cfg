
PART[*]:HAS[@VARS:HAS[#comm_type[*]]:AFTER[zPhase1Init]
{
	%ACTIONS
	{
		action = clear old antenna
	}

	!MODULE[ModuleDataTransmitter],* {}
	!MODULE[ModuleSPUPassive],* {}
	!MODULE[ModuleRTAntenna],* {}

	%MODULE[ModuleSPUPassive] {}
	@MODULE[ModuleAnimateGeneric]
	{
		%allowManualControl = false
	}
}

@PART[*]:HAS[@VARS:HAS[#comm_type[omni]]:AFTER[zPhase1Init]
{
	%ACTIONS
	{
		action = enable omni comms
	}

	%MODULE[ModuleRTAntenna]
	{
		%IsRTActive = true
		%Mode0OmniRange = 0
		%Mode1OmniRange = #$/VARS/comm_range$
	}
}

@PART[*]:HAS[@VARS:HAS[#comm_type[dish]]:AFTER[zPhase1Init]
{
	%ACTIONS
	{
		action = enable dish comms
	}

	%MODULE[ModuleRTAntenna]
	{
		%Mode0DishRange = 0
		%Mode1DishRange = #$/VARS/comm_range$
		%MaxQ = 6000
		%DishAngle = #$/VARS/comm_angle$
	}
}

PART[*]:HAS[@VARS:HAS[#comm_anim[*]]:AFTER[zPhase1Init]
{
	%ACTIONS
	{
		action = set comms anim
	}

	%MODULE[ModuleRTAntenna]
	{
		%DeployFxModules = #$/VARS/comm_anim$
	}
}

PART[*]:HAS[@VARS:HAS[#comm_type[*]]:AFTER[zPhase1Init]
{
	%ACTIONS
	{
		action = calculate antenna Watts
	}

	%MODULE[ModuleRTAntenna]
	{
		%EnergyCost = #$/VARS/comm_drain$
		@EnergyCost /= #$@MM_VARS/SecondsPerHour$
		%TRANSMITTER
		{
			%PacketInterval = 0.3
			%PacketSize = 2
			%PacketResourceCost = 1
		}
	}
}
