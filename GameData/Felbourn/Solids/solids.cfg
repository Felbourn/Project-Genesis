
@PART[*]:HAS[@MODULE[ModuleEngines*]&#solid_fuel_engine[*]]:AFTER[zAll]
{
	%ACTIONS
	{
		action = ensure ModuleEnginesRF & set thrust
	}
	@MODULE[ModuleEngines*]
	{
		@name = ModuleEnginesRF
		@maxThrust = #$/mass$
		@maxThrust *= #$@MM_VARS/SolidTWR$
		@maxThrust *= #$@MM_VARS/Gravity$
		@maxThrust /= #$@MM_VARS/KgPerTon$
		@PROPELLANT[SolidFuel]
		{
			@name = HTPB
		}
	}
}

@PART[*]:HAS[@MODULE[ModuleEngines*]&#solid_engine_thrust[*]]:AFTER[zAll]
{
	%ACTIONS
	{
		action = override default solid rocket thrust
	}
	@MODULE[ModuleEnginesRF]
	{
		@maxThrust = #$/solid_engine_thrust$
	}
}

@PART[*]:HAS[@MODULE[ModuleEngines*]&@PLUME[Solid*]]:AFTER[zAll]
{
	%ACTIONS
	{
		action = define ModuleEngineConfigs for solid thrust curves
	}
	MODULE
	{
		name = ModuleEngineConfigs
		type = ModuleEnginesRF
		configuration = Linear
		
		CONFIG
		{
			name = Linear Thrust
			thrustCurve
			{
				key = 0.00 0.01
				key = 0.02 0.01
				key = 0.03 0.16
				key = 0.06 0.32
				key = 1.00 1.00
			}
		}
		CONFIG
		{
			name = MaxQ Reduced
			thrustCurve
			{
				key = 0.00 0.01
				key = 0.02 0.01
				key = 0.03 0.16
				key = 0.04 0.20
				key = 0.60 0.99
				key = 0.80 0.60
				key = 0.94 1.00
				key = 1.00 0.90
			}
		}
		CONFIG
		{
			name = Delayed Fuse
			thrustCurve
			{
				key = 0.00 0.00
				key = 0.01 0.01
				key = 0.03 0.20
				key = 0.60 0.98
				key = 0.61 0.97
				key = 0.78 0.22
				key = 1.00 0.10
			}
		}
	}

	@MODULE[ModuleEngineConfigs]
	{
		@CONFIG,*
		{		
			minThrust = 0
			maxThrust = #$/MODULE[ModuleEnginesRF]/maxThrust$
			chamberNominalTemp = 1800
			maxEngineTemp = 2050
			PROPELLANT
			{
				name = HTPB
				ratio = 1
				DrawGauge = True
			}
			atmosphereCurve
			{
				key = 0 182
				key = 1 151
				key = 3 0.001
			}
			curveResource = HTPB
		}
	}
}
